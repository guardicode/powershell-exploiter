from typing import List

from pydantic import Field

from common.base_models import InfectionMonkeyBaseModel
from common.types import NetworkPort


class PowerShellOptions(InfectionMonkeyBaseModel):
    target_ports: List[NetworkPort] = Field(
        default=[5985, 5986],
        description="A list of ports that the PowerShell exploiter will try to exploit.",
    )
    try_all_discovered_open_ports: bool = Field(
        default=False,
        description="Attempt to exploit PowerShell on all open ports with unknown "
        "services discovered from network scanning.",
    )
    winrm_connect_timeout: float = Field(
        default=3.0,
        gt=0.0,
        le=100.0,
        description="The maximum time (in seconds) to wait for a response on a WinRM connection.",
    )
